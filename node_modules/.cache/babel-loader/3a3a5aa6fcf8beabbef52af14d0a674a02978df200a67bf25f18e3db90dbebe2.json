{"ast":null,"code":"\"use strict\";\n\n/*!\n * Copyright 2019 Google Inc. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ResourceStream = void 0;\nconst stream_1 = require(\"stream\");\nclass ResourceStream extends stream_1.Transform {\n  constructor(args, requestFn) {\n    const options = Object.assign({\n      objectMode: true\n    }, args.streamOptions);\n    super(options);\n    this._ended = false;\n    this._maxApiCalls = args.maxApiCalls === -1 ? Infinity : args.maxApiCalls;\n    this._nextQuery = args.query;\n    this._reading = false;\n    this._requestFn = requestFn;\n    this._requestsMade = 0;\n    this._resultsToSend = args.maxResults === -1 ? Infinity : args.maxResults;\n  }\n  /* eslint-disable  @typescript-eslint/no-explicit-any */\n  end() {\n    this._ended = true;\n    return super.end(...arguments);\n  }\n  _read() {\n    if (this._reading) {\n      return;\n    }\n    this._reading = true;\n    // Wrap in a try/catch to catch input linting errors, e.g.\n    // an invalid BigQuery query. These errors are thrown in an\n    // async fashion, which makes them un-catchable by the user.\n    try {\n      this._requestFn(this._nextQuery, (err, results, nextQuery) => {\n        if (err) {\n          this.destroy(err);\n          return;\n        }\n        this._nextQuery = nextQuery;\n        if (this._resultsToSend !== Infinity) {\n          results = results.splice(0, this._resultsToSend);\n          this._resultsToSend -= results.length;\n        }\n        let more = true;\n        for (const result of results) {\n          if (this._ended) {\n            break;\n          }\n          more = this.push(result);\n        }\n        const isFinished = !this._nextQuery || this._resultsToSend < 1;\n        const madeMaxCalls = ++this._requestsMade >= this._maxApiCalls;\n        if (isFinished || madeMaxCalls) {\n          this.end();\n        }\n        if (more && !this._ended) {\n          setImmediate(() => this._read());\n        }\n        this._reading = false;\n      });\n    } catch (e) {\n      this.destroy(e);\n    }\n  }\n}\nexports.ResourceStream = ResourceStream;","map":{"version":3,"names":["Object","defineProperty","exports","value","ResourceStream","stream_1","require","Transform","constructor","args","requestFn","options","assign","objectMode","streamOptions","_ended","_maxApiCalls","maxApiCalls","Infinity","_nextQuery","query","_reading","_requestFn","_requestsMade","_resultsToSend","maxResults","end","arguments","_read","err","results","nextQuery","destroy","splice","length","more","result","push","isFinished","madeMaxCalls","setImmediate","e"],"sources":["D:/Coding/React/taskmybusiness/node_modules/@google-cloud/paginator/build/src/resource-stream.js"],"sourcesContent":["\"use strict\";\n/*!\n * Copyright 2019 Google Inc. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ResourceStream = void 0;\nconst stream_1 = require(\"stream\");\nclass ResourceStream extends stream_1.Transform {\n    constructor(args, requestFn) {\n        const options = Object.assign({ objectMode: true }, args.streamOptions);\n        super(options);\n        this._ended = false;\n        this._maxApiCalls = args.maxApiCalls === -1 ? Infinity : args.maxApiCalls;\n        this._nextQuery = args.query;\n        this._reading = false;\n        this._requestFn = requestFn;\n        this._requestsMade = 0;\n        this._resultsToSend = args.maxResults === -1 ? Infinity : args.maxResults;\n    }\n    /* eslint-disable  @typescript-eslint/no-explicit-any */\n    end(...args) {\n        this._ended = true;\n        return super.end(...args);\n    }\n    _read() {\n        if (this._reading) {\n            return;\n        }\n        this._reading = true;\n        // Wrap in a try/catch to catch input linting errors, e.g.\n        // an invalid BigQuery query. These errors are thrown in an\n        // async fashion, which makes them un-catchable by the user.\n        try {\n            this._requestFn(this._nextQuery, (err, results, nextQuery) => {\n                if (err) {\n                    this.destroy(err);\n                    return;\n                }\n                this._nextQuery = nextQuery;\n                if (this._resultsToSend !== Infinity) {\n                    results = results.splice(0, this._resultsToSend);\n                    this._resultsToSend -= results.length;\n                }\n                let more = true;\n                for (const result of results) {\n                    if (this._ended) {\n                        break;\n                    }\n                    more = this.push(result);\n                }\n                const isFinished = !this._nextQuery || this._resultsToSend < 1;\n                const madeMaxCalls = ++this._requestsMade >= this._maxApiCalls;\n                if (isFinished || madeMaxCalls) {\n                    this.end();\n                }\n                if (more && !this._ended) {\n                    setImmediate(() => this._read());\n                }\n                this._reading = false;\n            });\n        }\n        catch (e) {\n            this.destroy(e);\n        }\n    }\n}\nexports.ResourceStream = ResourceStream;\n//# sourceMappingURL=resource-stream.js.map"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}