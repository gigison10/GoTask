{"ast":null,"code":"import crypto from './webcrypto.js';\nimport { JOSENotSupported } from '../util/errors.js';\nimport random from './random.js';\nexport async function generateSecret(alg, options) {\n  var _a;\n  let length;\n  let algorithm;\n  let keyUsages;\n  switch (alg) {\n    case 'HS256':\n    case 'HS384':\n    case 'HS512':\n      length = parseInt(alg.slice(-3), 10);\n      algorithm = {\n        name: 'HMAC',\n        hash: `SHA-${length}`,\n        length\n      };\n      keyUsages = ['sign', 'verify'];\n      break;\n    case 'A128CBC-HS256':\n    case 'A192CBC-HS384':\n    case 'A256CBC-HS512':\n      length = parseInt(alg.slice(-3), 10);\n      return random(new Uint8Array(length >> 3));\n    case 'A128KW':\n    case 'A192KW':\n    case 'A256KW':\n      length = parseInt(alg.slice(1, 4), 10);\n      algorithm = {\n        name: 'AES-KW',\n        length\n      };\n      keyUsages = ['wrapKey', 'unwrapKey'];\n      break;\n    case 'A128GCMKW':\n    case 'A192GCMKW':\n    case 'A256GCMKW':\n    case 'A128GCM':\n    case 'A192GCM':\n    case 'A256GCM':\n      length = parseInt(alg.slice(1, 4), 10);\n      algorithm = {\n        name: 'AES-GCM',\n        length\n      };\n      keyUsages = ['encrypt', 'decrypt'];\n      break;\n    default:\n      throw new JOSENotSupported('Invalid or unsupported JWK \"alg\" (Algorithm) Parameter value');\n  }\n  return crypto.subtle.generateKey(algorithm, (_a = options === null || options === void 0 ? void 0 : options.extractable) !== null && _a !== void 0 ? _a : false, keyUsages);\n}\nfunction getModulusLengthOption(options) {\n  var _a;\n  const modulusLength = (_a = options === null || options === void 0 ? void 0 : options.modulusLength) !== null && _a !== void 0 ? _a : 2048;\n  if (typeof modulusLength !== 'number' || modulusLength < 2048) {\n    throw new JOSENotSupported('Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used');\n  }\n  return modulusLength;\n}\nexport async function generateKeyPair(alg, options) {\n  var _a, _b, _c;\n  let algorithm;\n  let keyUsages;\n  switch (alg) {\n    case 'PS256':\n    case 'PS384':\n    case 'PS512':\n      algorithm = {\n        name: 'RSA-PSS',\n        hash: `SHA-${alg.slice(-3)}`,\n        publicExponent: new Uint8Array([0x01, 0x00, 0x01]),\n        modulusLength: getModulusLengthOption(options)\n      };\n      keyUsages = ['sign', 'verify'];\n      break;\n    case 'RS256':\n    case 'RS384':\n    case 'RS512':\n      algorithm = {\n        name: 'RSASSA-PKCS1-v1_5',\n        hash: `SHA-${alg.slice(-3)}`,\n        publicExponent: new Uint8Array([0x01, 0x00, 0x01]),\n        modulusLength: getModulusLengthOption(options)\n      };\n      keyUsages = ['sign', 'verify'];\n      break;\n    case 'RSA-OAEP':\n    case 'RSA-OAEP-256':\n    case 'RSA-OAEP-384':\n    case 'RSA-OAEP-512':\n      algorithm = {\n        name: 'RSA-OAEP',\n        hash: `SHA-${parseInt(alg.slice(-3), 10) || 1}`,\n        publicExponent: new Uint8Array([0x01, 0x00, 0x01]),\n        modulusLength: getModulusLengthOption(options)\n      };\n      keyUsages = ['decrypt', 'unwrapKey', 'encrypt', 'wrapKey'];\n      break;\n    case 'ES256':\n      algorithm = {\n        name: 'ECDSA',\n        namedCurve: 'P-256'\n      };\n      keyUsages = ['sign', 'verify'];\n      break;\n    case 'ES384':\n      algorithm = {\n        name: 'ECDSA',\n        namedCurve: 'P-384'\n      };\n      keyUsages = ['sign', 'verify'];\n      break;\n    case 'ES512':\n      algorithm = {\n        name: 'ECDSA',\n        namedCurve: 'P-521'\n      };\n      keyUsages = ['sign', 'verify'];\n      break;\n    case 'EdDSA':\n      keyUsages = ['sign', 'verify'];\n      const crv = (_a = options === null || options === void 0 ? void 0 : options.crv) !== null && _a !== void 0 ? _a : 'Ed25519';\n      switch (crv) {\n        case 'Ed25519':\n        case 'Ed448':\n          algorithm = {\n            name: crv\n          };\n          break;\n        default:\n          throw new JOSENotSupported('Invalid or unsupported crv option provided');\n      }\n      break;\n    case 'ECDH-ES':\n    case 'ECDH-ES+A128KW':\n    case 'ECDH-ES+A192KW':\n    case 'ECDH-ES+A256KW':\n      {\n        keyUsages = ['deriveKey', 'deriveBits'];\n        const crv = (_b = options === null || options === void 0 ? void 0 : options.crv) !== null && _b !== void 0 ? _b : 'P-256';\n        switch (crv) {\n          case 'P-256':\n          case 'P-384':\n          case 'P-521':\n            {\n              algorithm = {\n                name: 'ECDH',\n                namedCurve: crv\n              };\n              break;\n            }\n          case 'X25519':\n          case 'X448':\n            algorithm = {\n              name: crv\n            };\n            break;\n          default:\n            throw new JOSENotSupported('Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, X25519, and X448');\n        }\n        break;\n      }\n    default:\n      throw new JOSENotSupported('Invalid or unsupported JWK \"alg\" (Algorithm) Parameter value');\n  }\n  return crypto.subtle.generateKey(algorithm, (_c = options === null || options === void 0 ? void 0 : options.extractable) !== null && _c !== void 0 ? _c : false, keyUsages);\n}","map":{"version":3,"names":["crypto","JOSENotSupported","random","generateSecret","alg","options","_a","length","algorithm","keyUsages","parseInt","slice","name","hash","Uint8Array","subtle","generateKey","extractable","getModulusLengthOption","modulusLength","generateKeyPair","_b","_c","publicExponent","namedCurve","crv"],"sources":["D:/Coding/React/taskmybusiness/node_modules/jose/dist/browser/runtime/generate.js"],"sourcesContent":["import crypto from './webcrypto.js';\nimport { JOSENotSupported } from '../util/errors.js';\nimport random from './random.js';\nexport async function generateSecret(alg, options) {\n    var _a;\n    let length;\n    let algorithm;\n    let keyUsages;\n    switch (alg) {\n        case 'HS256':\n        case 'HS384':\n        case 'HS512':\n            length = parseInt(alg.slice(-3), 10);\n            algorithm = { name: 'HMAC', hash: `SHA-${length}`, length };\n            keyUsages = ['sign', 'verify'];\n            break;\n        case 'A128CBC-HS256':\n        case 'A192CBC-HS384':\n        case 'A256CBC-HS512':\n            length = parseInt(alg.slice(-3), 10);\n            return random(new Uint8Array(length >> 3));\n        case 'A128KW':\n        case 'A192KW':\n        case 'A256KW':\n            length = parseInt(alg.slice(1, 4), 10);\n            algorithm = { name: 'AES-KW', length };\n            keyUsages = ['wrapKey', 'unwrapKey'];\n            break;\n        case 'A128GCMKW':\n        case 'A192GCMKW':\n        case 'A256GCMKW':\n        case 'A128GCM':\n        case 'A192GCM':\n        case 'A256GCM':\n            length = parseInt(alg.slice(1, 4), 10);\n            algorithm = { name: 'AES-GCM', length };\n            keyUsages = ['encrypt', 'decrypt'];\n            break;\n        default:\n            throw new JOSENotSupported('Invalid or unsupported JWK \"alg\" (Algorithm) Parameter value');\n    }\n    return crypto.subtle.generateKey(algorithm, (_a = options === null || options === void 0 ? void 0 : options.extractable) !== null && _a !== void 0 ? _a : false, keyUsages);\n}\nfunction getModulusLengthOption(options) {\n    var _a;\n    const modulusLength = (_a = options === null || options === void 0 ? void 0 : options.modulusLength) !== null && _a !== void 0 ? _a : 2048;\n    if (typeof modulusLength !== 'number' || modulusLength < 2048) {\n        throw new JOSENotSupported('Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used');\n    }\n    return modulusLength;\n}\nexport async function generateKeyPair(alg, options) {\n    var _a, _b, _c;\n    let algorithm;\n    let keyUsages;\n    switch (alg) {\n        case 'PS256':\n        case 'PS384':\n        case 'PS512':\n            algorithm = {\n                name: 'RSA-PSS',\n                hash: `SHA-${alg.slice(-3)}`,\n                publicExponent: new Uint8Array([0x01, 0x00, 0x01]),\n                modulusLength: getModulusLengthOption(options),\n            };\n            keyUsages = ['sign', 'verify'];\n            break;\n        case 'RS256':\n        case 'RS384':\n        case 'RS512':\n            algorithm = {\n                name: 'RSASSA-PKCS1-v1_5',\n                hash: `SHA-${alg.slice(-3)}`,\n                publicExponent: new Uint8Array([0x01, 0x00, 0x01]),\n                modulusLength: getModulusLengthOption(options),\n            };\n            keyUsages = ['sign', 'verify'];\n            break;\n        case 'RSA-OAEP':\n        case 'RSA-OAEP-256':\n        case 'RSA-OAEP-384':\n        case 'RSA-OAEP-512':\n            algorithm = {\n                name: 'RSA-OAEP',\n                hash: `SHA-${parseInt(alg.slice(-3), 10) || 1}`,\n                publicExponent: new Uint8Array([0x01, 0x00, 0x01]),\n                modulusLength: getModulusLengthOption(options),\n            };\n            keyUsages = ['decrypt', 'unwrapKey', 'encrypt', 'wrapKey'];\n            break;\n        case 'ES256':\n            algorithm = { name: 'ECDSA', namedCurve: 'P-256' };\n            keyUsages = ['sign', 'verify'];\n            break;\n        case 'ES384':\n            algorithm = { name: 'ECDSA', namedCurve: 'P-384' };\n            keyUsages = ['sign', 'verify'];\n            break;\n        case 'ES512':\n            algorithm = { name: 'ECDSA', namedCurve: 'P-521' };\n            keyUsages = ['sign', 'verify'];\n            break;\n        case 'EdDSA':\n            keyUsages = ['sign', 'verify'];\n            const crv = (_a = options === null || options === void 0 ? void 0 : options.crv) !== null && _a !== void 0 ? _a : 'Ed25519';\n            switch (crv) {\n                case 'Ed25519':\n                case 'Ed448':\n                    algorithm = { name: crv };\n                    break;\n                default:\n                    throw new JOSENotSupported('Invalid or unsupported crv option provided');\n            }\n            break;\n        case 'ECDH-ES':\n        case 'ECDH-ES+A128KW':\n        case 'ECDH-ES+A192KW':\n        case 'ECDH-ES+A256KW': {\n            keyUsages = ['deriveKey', 'deriveBits'];\n            const crv = (_b = options === null || options === void 0 ? void 0 : options.crv) !== null && _b !== void 0 ? _b : 'P-256';\n            switch (crv) {\n                case 'P-256':\n                case 'P-384':\n                case 'P-521': {\n                    algorithm = { name: 'ECDH', namedCurve: crv };\n                    break;\n                }\n                case 'X25519':\n                case 'X448':\n                    algorithm = { name: crv };\n                    break;\n                default:\n                    throw new JOSENotSupported('Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, X25519, and X448');\n            }\n            break;\n        }\n        default:\n            throw new JOSENotSupported('Invalid or unsupported JWK \"alg\" (Algorithm) Parameter value');\n    }\n    return (crypto.subtle.generateKey(algorithm, (_c = options === null || options === void 0 ? void 0 : options.extractable) !== null && _c !== void 0 ? _c : false, keyUsages));\n}\n"],"mappings":"AAAA,OAAOA,MAAM,MAAM,gBAAgB;AACnC,SAASC,gBAAgB,QAAQ,mBAAmB;AACpD,OAAOC,MAAM,MAAM,aAAa;AAChC,OAAO,eAAeC,cAAcA,CAACC,GAAG,EAAEC,OAAO,EAAE;EAC/C,IAAIC,EAAE;EACN,IAAIC,MAAM;EACV,IAAIC,SAAS;EACb,IAAIC,SAAS;EACb,QAAQL,GAAG;IACP,KAAK,OAAO;IACZ,KAAK,OAAO;IACZ,KAAK,OAAO;MACRG,MAAM,GAAGG,QAAQ,CAACN,GAAG,CAACO,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;MACpCH,SAAS,GAAG;QAAEI,IAAI,EAAE,MAAM;QAAEC,IAAI,EAAG,OAAMN,MAAO,EAAC;QAAEA;MAAO,CAAC;MAC3DE,SAAS,GAAG,CAAC,MAAM,EAAE,QAAQ,CAAC;MAC9B;IACJ,KAAK,eAAe;IACpB,KAAK,eAAe;IACpB,KAAK,eAAe;MAChBF,MAAM,GAAGG,QAAQ,CAACN,GAAG,CAACO,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;MACpC,OAAOT,MAAM,CAAC,IAAIY,UAAU,CAACP,MAAM,IAAI,CAAC,CAAC,CAAC;IAC9C,KAAK,QAAQ;IACb,KAAK,QAAQ;IACb,KAAK,QAAQ;MACTA,MAAM,GAAGG,QAAQ,CAACN,GAAG,CAACO,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC;MACtCH,SAAS,GAAG;QAAEI,IAAI,EAAE,QAAQ;QAAEL;MAAO,CAAC;MACtCE,SAAS,GAAG,CAAC,SAAS,EAAE,WAAW,CAAC;MACpC;IACJ,KAAK,WAAW;IAChB,KAAK,WAAW;IAChB,KAAK,WAAW;IAChB,KAAK,SAAS;IACd,KAAK,SAAS;IACd,KAAK,SAAS;MACVF,MAAM,GAAGG,QAAQ,CAACN,GAAG,CAACO,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC;MACtCH,SAAS,GAAG;QAAEI,IAAI,EAAE,SAAS;QAAEL;MAAO,CAAC;MACvCE,SAAS,GAAG,CAAC,SAAS,EAAE,SAAS,CAAC;MAClC;IACJ;MACI,MAAM,IAAIR,gBAAgB,CAAC,8DAA8D,CAAC;EAClG;EACA,OAAOD,MAAM,CAACe,MAAM,CAACC,WAAW,CAACR,SAAS,EAAE,CAACF,EAAE,GAAGD,OAAO,KAAK,IAAI,IAAIA,OAAO,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,OAAO,CAACY,WAAW,MAAM,IAAI,IAAIX,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAG,KAAK,EAAEG,SAAS,CAAC;AAC/K;AACA,SAASS,sBAAsBA,CAACb,OAAO,EAAE;EACrC,IAAIC,EAAE;EACN,MAAMa,aAAa,GAAG,CAACb,EAAE,GAAGD,OAAO,KAAK,IAAI,IAAIA,OAAO,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,OAAO,CAACc,aAAa,MAAM,IAAI,IAAIb,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAG,IAAI;EAC1I,IAAI,OAAOa,aAAa,KAAK,QAAQ,IAAIA,aAAa,GAAG,IAAI,EAAE;IAC3D,MAAM,IAAIlB,gBAAgB,CAAC,6FAA6F,CAAC;EAC7H;EACA,OAAOkB,aAAa;AACxB;AACA,OAAO,eAAeC,eAAeA,CAAChB,GAAG,EAAEC,OAAO,EAAE;EAChD,IAAIC,EAAE,EAAEe,EAAE,EAAEC,EAAE;EACd,IAAId,SAAS;EACb,IAAIC,SAAS;EACb,QAAQL,GAAG;IACP,KAAK,OAAO;IACZ,KAAK,OAAO;IACZ,KAAK,OAAO;MACRI,SAAS,GAAG;QACRI,IAAI,EAAE,SAAS;QACfC,IAAI,EAAG,OAAMT,GAAG,CAACO,KAAK,CAAC,CAAC,CAAC,CAAE,EAAC;QAC5BY,cAAc,EAAE,IAAIT,UAAU,CAAC,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;QAClDK,aAAa,EAAED,sBAAsB,CAACb,OAAO;MACjD,CAAC;MACDI,SAAS,GAAG,CAAC,MAAM,EAAE,QAAQ,CAAC;MAC9B;IACJ,KAAK,OAAO;IACZ,KAAK,OAAO;IACZ,KAAK,OAAO;MACRD,SAAS,GAAG;QACRI,IAAI,EAAE,mBAAmB;QACzBC,IAAI,EAAG,OAAMT,GAAG,CAACO,KAAK,CAAC,CAAC,CAAC,CAAE,EAAC;QAC5BY,cAAc,EAAE,IAAIT,UAAU,CAAC,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;QAClDK,aAAa,EAAED,sBAAsB,CAACb,OAAO;MACjD,CAAC;MACDI,SAAS,GAAG,CAAC,MAAM,EAAE,QAAQ,CAAC;MAC9B;IACJ,KAAK,UAAU;IACf,KAAK,cAAc;IACnB,KAAK,cAAc;IACnB,KAAK,cAAc;MACfD,SAAS,GAAG;QACRI,IAAI,EAAE,UAAU;QAChBC,IAAI,EAAG,OAAMH,QAAQ,CAACN,GAAG,CAACO,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,IAAI,CAAE,EAAC;QAC/CY,cAAc,EAAE,IAAIT,UAAU,CAAC,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;QAClDK,aAAa,EAAED,sBAAsB,CAACb,OAAO;MACjD,CAAC;MACDI,SAAS,GAAG,CAAC,SAAS,EAAE,WAAW,EAAE,SAAS,EAAE,SAAS,CAAC;MAC1D;IACJ,KAAK,OAAO;MACRD,SAAS,GAAG;QAAEI,IAAI,EAAE,OAAO;QAAEY,UAAU,EAAE;MAAQ,CAAC;MAClDf,SAAS,GAAG,CAAC,MAAM,EAAE,QAAQ,CAAC;MAC9B;IACJ,KAAK,OAAO;MACRD,SAAS,GAAG;QAAEI,IAAI,EAAE,OAAO;QAAEY,UAAU,EAAE;MAAQ,CAAC;MAClDf,SAAS,GAAG,CAAC,MAAM,EAAE,QAAQ,CAAC;MAC9B;IACJ,KAAK,OAAO;MACRD,SAAS,GAAG;QAAEI,IAAI,EAAE,OAAO;QAAEY,UAAU,EAAE;MAAQ,CAAC;MAClDf,SAAS,GAAG,CAAC,MAAM,EAAE,QAAQ,CAAC;MAC9B;IACJ,KAAK,OAAO;MACRA,SAAS,GAAG,CAAC,MAAM,EAAE,QAAQ,CAAC;MAC9B,MAAMgB,GAAG,GAAG,CAACnB,EAAE,GAAGD,OAAO,KAAK,IAAI,IAAIA,OAAO,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,OAAO,CAACoB,GAAG,MAAM,IAAI,IAAInB,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAG,SAAS;MAC3H,QAAQmB,GAAG;QACP,KAAK,SAAS;QACd,KAAK,OAAO;UACRjB,SAAS,GAAG;YAAEI,IAAI,EAAEa;UAAI,CAAC;UACzB;QACJ;UACI,MAAM,IAAIxB,gBAAgB,CAAC,4CAA4C,CAAC;MAChF;MACA;IACJ,KAAK,SAAS;IACd,KAAK,gBAAgB;IACrB,KAAK,gBAAgB;IACrB,KAAK,gBAAgB;MAAE;QACnBQ,SAAS,GAAG,CAAC,WAAW,EAAE,YAAY,CAAC;QACvC,MAAMgB,GAAG,GAAG,CAACJ,EAAE,GAAGhB,OAAO,KAAK,IAAI,IAAIA,OAAO,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,OAAO,CAACoB,GAAG,MAAM,IAAI,IAAIJ,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAG,OAAO;QACzH,QAAQI,GAAG;UACP,KAAK,OAAO;UACZ,KAAK,OAAO;UACZ,KAAK,OAAO;YAAE;cACVjB,SAAS,GAAG;gBAAEI,IAAI,EAAE,MAAM;gBAAEY,UAAU,EAAEC;cAAI,CAAC;cAC7C;YACJ;UACA,KAAK,QAAQ;UACb,KAAK,MAAM;YACPjB,SAAS,GAAG;cAAEI,IAAI,EAAEa;YAAI,CAAC;YACzB;UACJ;YACI,MAAM,IAAIxB,gBAAgB,CAAC,wGAAwG,CAAC;QAC5I;QACA;MACJ;IACA;MACI,MAAM,IAAIA,gBAAgB,CAAC,8DAA8D,CAAC;EAClG;EACA,OAAQD,MAAM,CAACe,MAAM,CAACC,WAAW,CAACR,SAAS,EAAE,CAACc,EAAE,GAAGjB,OAAO,KAAK,IAAI,IAAIA,OAAO,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,OAAO,CAACY,WAAW,MAAM,IAAI,IAAIK,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAG,KAAK,EAAEb,SAAS,CAAC;AAChL"},"metadata":{},"sourceType":"module","externalDependencies":[]}