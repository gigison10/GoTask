{"ast":null,"code":"import _slicedToArray from\"D:/Coding/React/taskmybusiness/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import\"./projectList.scss\";import{Fragment,useState,useEffect,useRef,useContext,forwardRef,useImperativeHandle}from\"react\";import{useGetTodosQuery,useDeleteTodoMutation,useUpdateTodoMutation}from\"../../utils/firebase/firebase-utils\";import{UserContext}from\"../../contexts/context\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ProjectList(props,ref){var _useContext=useContext(UserContext),currentUserId=_useContext.currentUserId,setCurrentUserId=_useContext.setCurrentUserId;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),projectDetails=_useState2[0],setProjectDetails=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),currentProject=_useState4[0],setCurrentProject=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),editProjectId=_useState6[0],setEditProjectId=_useState6[1];var projectNameRef=useRef(\"\");var projectStartingDateRef=useRef(\"\");var projectDeadLineRef=useRef(\"\");//////////////////////////////////\nvar _useGetTodosQuery=useGetTodosQuery(currentUserId,{skip:!currentUserId// Enable the query when userId is truthy\n}),projects=_useGetTodosQuery.data,isLoading=_useGetTodosQuery.isLoading,isSuccess=_useGetTodosQuery.isSuccess,isError=_useGetTodosQuery.isError,error=_useGetTodosQuery.error,refetch=_useGetTodosQuery.refetch;var _useDeleteTodoMutatio=useDeleteTodoMutation(),_useDeleteTodoMutatio2=_slicedToArray(_useDeleteTodoMutatio,1),deleteTodo=_useDeleteTodoMutatio2[0];var _useUpdateTodoMutatio=useUpdateTodoMutation(),_useUpdateTodoMutatio2=_slicedToArray(_useUpdateTodoMutatio,1),updateTodo=_useUpdateTodoMutatio2[0];/////////////////////////////////////////////\nuseEffect(function(){if(currentUserId&&projects&&isSuccess){var _projects$documents;// setUserId(currentUserId.uid);\nvar arr=projects===null||projects===void 0?void 0:(_projects$documents=projects.documents)===null||_projects$documents===void 0?void 0:_projects$documents.map(function(project){var _ref=(project===null||project===void 0?void 0:project.fields)||{},deadLine=_ref.deadLine,projectId=_ref.projectId,projectName=_ref.projectName,startingDate=_ref.startingDate;return{deadLine:(deadLine===null||deadLine===void 0?void 0:deadLine.stringValue)||\"\",projectId:(projectId===null||projectId===void 0?void 0:projectId.stringValue)||\"\",projectName:(projectName===null||projectName===void 0?void 0:projectName.stringValue)||\"\",startingDate:(startingDate===null||startingDate===void 0?void 0:startingDate.stringValue)||\"\"};});setProjectDetails(arr);}if(!currentUserId){setProjectDetails([]);}},[currentUserId,projects]);////refetching after add a new project from parent component///////////\nfunction reFetch(){setTimeout(function(){refetch();},400);}useImperativeHandle(ref,function(){return{reFetch:reFetch};});///////////////////////////////////\nvar handleKeyDown=function handleKeyDown(event){if(event.key===\"Enter\"){handleEditClick(editProjectId);}};var editField=function editField(data,inputField,ref){if(data.projectId===editProjectId){return/*#__PURE__*/_jsx(\"input\",{className:\"inputProjectField\",autoFocus:true,type:\"text\",defaultValue:inputField,ref:ref,onKeyDown:handleKeyDown});}else{return/*#__PURE__*/_jsx(\"h5\",{children:inputField});}};var isEditing=function isEditing(projectId){return projectId===editProjectId;};var handleEditClick=function handleEditClick(projectId){if(isEditing(projectId)){updateTodo({id:editProjectId,projectName:projectNameRef.current.value,deadLine:projectDeadLineRef.current.value,startingDate:projectStartingDateRef.current.value}).then(function(response){// Handle the success response if needed\nconsole.log(response);setEditProjectId(null);}).catch(function(error){// Handle the error if needed\n});reFetch();}else{setEditProjectId(projectId);}};////////////////////////////////\nreturn/*#__PURE__*/_jsx(Fragment,{children:projectDetails===null||projectDetails===void 0?void 0:projectDetails.map(function(data){return/*#__PURE__*/_jsxs(\"div\",{className:\"project-field\",children:[/*#__PURE__*/_jsxs(\"div\",{type:\"submit\",className:\"checkBlock\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"check\",type:\"checkbox\"}),/*#__PURE__*/_jsx(\"button\",{className:\"deteButton\",onClick:function onClick(){return deleteTodo(data.projectId);},children:\"delete\"})]}),editField(data,data.projectName,projectNameRef),editField(data,data.startingDate,projectStartingDateRef),editField(data,data.deadLine,projectDeadLineRef),/*#__PURE__*/_jsx(\"h5\",{children:\"In progress\"}),/*#__PURE__*/_jsx(\"button\",{className:\"buttonField\",value:data.id,onClick:function onClick(){setCurrentProject(data);setEditProjectId(data.projectId);if(isEditing(data.projectId)){handleEditClick(data.projectId);}},children:isEditing(data.projectId)?\"Save\":\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{className:\"buttonField\",children:\"Mark as complete\"})]},data.projectId);})});}export default/*#__PURE__*/forwardRef(ProjectList);","map":{"version":3,"names":["Fragment","useState","useEffect","useRef","useContext","forwardRef","useImperativeHandle","useGetTodosQuery","useDeleteTodoMutation","useUpdateTodoMutation","UserContext","jsx","_jsx","jsxs","_jsxs","ProjectList","props","ref","_useContext","currentUserId","setCurrentUserId","_useState","_useState2","_slicedToArray","projectDetails","setProjectDetails","_useState3","_useState4","currentProject","setCurrentProject","_useState5","_useState6","editProjectId","setEditProjectId","projectNameRef","projectStartingDateRef","projectDeadLineRef","_useGetTodosQuery","skip","projects","data","isLoading","isSuccess","isError","error","refetch","_useDeleteTodoMutatio","_useDeleteTodoMutatio2","deleteTodo","_useUpdateTodoMutatio","_useUpdateTodoMutatio2","updateTodo","_projects$documents","arr","documents","map","project","_ref","fields","deadLine","projectId","projectName","startingDate","stringValue","reFetch","setTimeout","handleKeyDown","event","key","handleEditClick","editField","inputField","className","autoFocus","type","defaultValue","onKeyDown","children","isEditing","id","current","value","then","response","console","log","catch","onClick"],"sources":["D:/Coding/React/taskmybusiness/src/components/projectList/projectList.jsx"],"sourcesContent":["import \"./projectList.scss\";\r\nimport {\r\n  Fragment,\r\n  useState,\r\n  useEffect,\r\n  useRef,\r\n  useContext,\r\n  forwardRef,\r\n  useImperativeHandle,\r\n} from \"react\";\r\nimport {\r\n  useGetTodosQuery,\r\n  useDeleteTodoMutation,\r\n  useUpdateTodoMutation,\r\n} from \"../../utils/firebase/firebase-utils\";\r\nimport { UserContext } from \"../../contexts/context\";\r\n\r\nfunction ProjectList(props, ref) {\r\n  const { currentUserId, setCurrentUserId } = useContext(UserContext);\r\n  const [projectDetails, setProjectDetails] = useState([]);\r\n  const [currentProject, setCurrentProject] = useState([]);\r\n  const [editProjectId, setEditProjectId] = useState(null);\r\n  const projectNameRef = useRef(\"\");\r\n  const projectStartingDateRef = useRef(\"\");\r\n  const projectDeadLineRef = useRef(\"\");\r\n  //////////////////////////////////\r\n  const {\r\n    data: projects,\r\n    isLoading,\r\n    isSuccess,\r\n    isError,\r\n    error,\r\n    refetch,\r\n  } = useGetTodosQuery(currentUserId, {\r\n    skip: !currentUserId, // Enable the query when userId is truthy\r\n  });\r\n  const [deleteTodo] = useDeleteTodoMutation();\r\n  const [updateTodo] = useUpdateTodoMutation();\r\n  /////////////////////////////////////////////\r\n\r\n  useEffect(() => {\r\n    if (currentUserId && projects && isSuccess) {\r\n      // setUserId(currentUserId.uid);\r\n      const arr = projects?.documents?.map((project) => {\r\n        const { deadLine, projectId, projectName, startingDate } =\r\n          project?.fields || {};\r\n\r\n        return {\r\n          deadLine: deadLine?.stringValue || \"\",\r\n          projectId: projectId?.stringValue || \"\",\r\n          projectName: projectName?.stringValue || \"\",\r\n          startingDate: startingDate?.stringValue || \"\",\r\n        };\r\n      });\r\n\r\n      setProjectDetails(arr);\r\n    }\r\n    if (!currentUserId) {\r\n      setProjectDetails([]);\r\n    }\r\n  }, [currentUserId, projects]);\r\n\r\n  ////refetching after add a new project from parent component///////////\r\n  function reFetch() {\r\n    setTimeout(() => {\r\n      refetch();\r\n    }, 400);\r\n  }\r\n  useImperativeHandle(ref, () => ({\r\n    reFetch,\r\n  }));\r\n  ///////////////////////////////////\r\n\r\n  const handleKeyDown = (event) => {\r\n    if (event.key === \"Enter\") {\r\n      handleEditClick(editProjectId);\r\n    }\r\n  };\r\n\r\n  const editField = (data, inputField, ref) => {\r\n    if (data.projectId === editProjectId) {\r\n      return (\r\n        <input\r\n          className=\"inputProjectField\"\r\n          autoFocus\r\n          type=\"text\"\r\n          defaultValue={inputField}\r\n          ref={ref}\r\n          onKeyDown={handleKeyDown}\r\n        />\r\n      );\r\n    } else {\r\n      return <h5>{inputField}</h5>;\r\n    }\r\n  };\r\n\r\n  const isEditing = (projectId) => projectId === editProjectId;\r\n\r\n  const handleEditClick = (projectId) => {\r\n    if (isEditing(projectId)) {\r\n      updateTodo({\r\n        id: editProjectId,\r\n        projectName: projectNameRef.current.value,\r\n        deadLine: projectDeadLineRef.current.value,\r\n        startingDate: projectStartingDateRef.current.value,\r\n      })\r\n        .then((response) => {\r\n          // Handle the success response if needed\r\n          console.log(response);\r\n          setEditProjectId(null);\r\n        })\r\n        .catch((error) => {\r\n          // Handle the error if needed\r\n        });\r\n      reFetch();\r\n    } else {\r\n      setEditProjectId(projectId);\r\n    }\r\n  };\r\n\r\n  ////////////////////////////////\r\n  return (\r\n    <Fragment>\r\n      {projectDetails?.map((data) => (\r\n        <div className=\"project-field\" key={data.projectId}>\r\n          <div type=\"submit\" className=\"checkBlock\">\r\n            <input className=\"check\" type=\"checkbox\" />\r\n            <button\r\n              className=\"deteButton\"\r\n              onClick={() => deleteTodo(data.projectId)}\r\n            >\r\n              delete\r\n            </button>\r\n          </div>\r\n          {editField(data, data.projectName, projectNameRef)}\r\n          {editField(data, data.startingDate, projectStartingDateRef)}\r\n          {editField(data, data.deadLine, projectDeadLineRef)}\r\n          {/* <h5>{data.startingDate}</h5> */}\r\n          {/* <h5>{data.deadLine}</h5> */}\r\n          <h5>In progress</h5>\r\n          <button\r\n            className=\"buttonField\"\r\n            value={data.id}\r\n            onClick={() => {\r\n              setCurrentProject(data);\r\n              setEditProjectId(data.projectId);\r\n              if (isEditing(data.projectId)) {\r\n                handleEditClick(data.projectId);\r\n              }\r\n            }}\r\n          >\r\n            {isEditing(data.projectId) ? \"Save\" : \"Edit\"}\r\n          </button>\r\n          <button className=\"buttonField\">Mark as complete</button>\r\n        </div>\r\n      ))}\r\n    </Fragment>\r\n  );\r\n}\r\n\r\nexport default forwardRef(ProjectList);\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}