{"ast":null,"code":"\"use strict\";\n\n/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.fallback = exports.GoogleError = exports.operation = exports.Operation = exports.warn = exports.protobufMinimal = exports.protobuf = exports.createApiCall = exports.LocationProtos = exports.IamProtos = exports.operationsProtos = exports.lro = exports.GrpcClient = exports.defaultToObjectOptions = exports.LocationsClient = exports.IamClient = exports.OperationsClient = exports.StreamType = exports.StreamDescriptor = exports.PageDescriptor = exports.LongrunningDescriptor = exports.BundleDescriptor = exports.version = exports.createDefaultBackoffSettings = exports.RetryOptions = exports.constructSettings = exports.CallSettings = exports.routingHeader = exports.PathTemplate = void 0;\nconst objectHash = require(\"object-hash\");\nconst protobuf = require(\"protobufjs\");\nexports.protobuf = protobuf;\nconst gax = require(\"./gax\");\nconst routingHeader = require(\"./routingHeader\");\nexports.routingHeader = routingHeader;\nconst status_1 = require(\"./status\");\nconst google_auth_library_1 = require(\"google-auth-library\");\nconst operationsClient_1 = require(\"./operationsClient\");\nconst createApiCall_1 = require(\"./createApiCall\");\nconst fallbackProto = require(\"./fallbackProto\");\nconst fallbackRest = require(\"./fallbackRest\");\nconst featureDetection_1 = require(\"./featureDetection\");\nconst fallbackServiceStub_1 = require(\"./fallbackServiceStub\");\nconst streaming_1 = require(\"./streamingCalls/streaming\");\nconst util_1 = require(\"./util\");\nconst IamProtos = require(\"../protos/iam_service\");\nexports.IamProtos = IamProtos;\nconst LocationProtos = require(\"../protos/locations\");\nexports.LocationProtos = LocationProtos;\nconst operationsProtos = require(\"../protos/operations\");\nexports.operationsProtos = operationsProtos;\nvar pathTemplate_1 = require(\"./pathTemplate\");\nObject.defineProperty(exports, \"PathTemplate\", {\n  enumerable: true,\n  get: function () {\n    return pathTemplate_1.PathTemplate;\n  }\n});\nvar gax_1 = require(\"./gax\");\nObject.defineProperty(exports, \"CallSettings\", {\n  enumerable: true,\n  get: function () {\n    return gax_1.CallSettings;\n  }\n});\nObject.defineProperty(exports, \"constructSettings\", {\n  enumerable: true,\n  get: function () {\n    return gax_1.constructSettings;\n  }\n});\nObject.defineProperty(exports, \"RetryOptions\", {\n  enumerable: true,\n  get: function () {\n    return gax_1.RetryOptions;\n  }\n});\nObject.defineProperty(exports, \"createDefaultBackoffSettings\", {\n  enumerable: true,\n  get: function () {\n    return gax_1.createDefaultBackoffSettings;\n  }\n});\nexports.version = require('../../package.json').version + '-fallback';\nvar descriptor_1 = require(\"./descriptor\");\nObject.defineProperty(exports, \"BundleDescriptor\", {\n  enumerable: true,\n  get: function () {\n    return descriptor_1.BundleDescriptor;\n  }\n});\nObject.defineProperty(exports, \"LongrunningDescriptor\", {\n  enumerable: true,\n  get: function () {\n    return descriptor_1.LongrunningDescriptor;\n  }\n});\nObject.defineProperty(exports, \"PageDescriptor\", {\n  enumerable: true,\n  get: function () {\n    return descriptor_1.PageDescriptor;\n  }\n});\nObject.defineProperty(exports, \"StreamDescriptor\", {\n  enumerable: true,\n  get: function () {\n    return descriptor_1.StreamDescriptor;\n  }\n});\nvar streaming_2 = require(\"./streamingCalls/streaming\");\nObject.defineProperty(exports, \"StreamType\", {\n  enumerable: true,\n  get: function () {\n    return streaming_2.StreamType;\n  }\n});\nvar operationsClient_2 = require(\"./operationsClient\");\nObject.defineProperty(exports, \"OperationsClient\", {\n  enumerable: true,\n  get: function () {\n    return operationsClient_2.OperationsClient;\n  }\n});\nvar iamService_1 = require(\"./iamService\");\nObject.defineProperty(exports, \"IamClient\", {\n  enumerable: true,\n  get: function () {\n    return iamService_1.IamClient;\n  }\n});\nvar locationService_1 = require(\"./locationService\");\nObject.defineProperty(exports, \"LocationsClient\", {\n  enumerable: true,\n  get: function () {\n    return locationService_1.LocationsClient;\n  }\n});\nexports.defaultToObjectOptions = {\n  keepCase: false,\n  longs: String,\n  enums: String,\n  defaults: true,\n  oneofs: true\n};\nconst CLIENT_VERSION_HEADER = 'x-goog-api-client';\nclass GrpcClient {\n  /**\n   * In rare cases users might need to deallocate all memory consumed by loaded protos.\n   * This method will delete the proto cache content.\n   */\n  static clearProtoCache() {\n    GrpcClient.protoCache.clear();\n  }\n  /**\n   * gRPC-fallback version of GrpcClient\n   * Implements GrpcClient API for a browser using grpc-fallback protocol (sends serialized protobuf to HTTP/1 $rpc endpoint).\n   *\n   * @param {Object=} options.auth - An instance of OAuth2Client to use in browser, or an instance of GoogleAuth from google-auth-library\n   *  to use in Node.js. Required for browser, optional for Node.js.\n   * @constructor\n   */\n  constructor() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var _a;\n    if (!(0, featureDetection_1.isNodeJS)()) {\n      if (!options.auth) {\n        throw new Error(JSON.stringify(options) + 'You need to pass auth instance to use gRPC-fallback client in browser or other non-Node.js environments. Use OAuth2Client from google-auth-library.');\n      }\n      this.auth = options.auth;\n    } else {\n      this.auth = options.auth || new google_auth_library_1.GoogleAuth(options);\n    }\n    this.fallback = options.fallback !== 'rest' ? 'proto' : 'rest';\n    this.grpcVersion = require('../../package.json').version;\n    this.httpRules = options.httpRules;\n    this.numericEnums = (_a = options.numericEnums) !== null && _a !== void 0 ? _a : false;\n  }\n  /**\n   * gRPC-fallback version of loadProto\n   * Loads the protobuf root object from a JSON object created from a proto file\n   * @param {Object} jsonObject - A JSON version of a protofile created usin protobuf.js\n   * @returns {Object} Root namespace of proto JSON\n   */\n  loadProto(jsonObject) {\n    const rootObject = protobuf.Root.fromJSON(jsonObject);\n    return rootObject;\n  }\n  loadProtoJSON(json) {\n    let ignoreCache = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    const hash = objectHash(JSON.stringify(json)).toString();\n    const cached = GrpcClient.protoCache.get(hash);\n    if (cached && !ignoreCache) {\n      return cached;\n    }\n    const root = protobuf.Root.fromJSON(json);\n    GrpcClient.protoCache.set(hash, root);\n    return root;\n  }\n  static getServiceMethods(service) {\n    const methods = {};\n    for (const [methodName, methodObject] of Object.entries(service.methods)) {\n      const methodNameLowerCamelCase = (0, util_1.toLowerCamelCase)(methodName);\n      methods[methodNameLowerCamelCase] = methodObject;\n    }\n    return methods;\n  }\n  /**\n   * gRPC-fallback version of constructSettings\n   * A wrapper of {@link constructSettings} function under the gRPC context.\n   *\n   * Most of parameters are common among constructSettings, please take a look.\n   * @param {string} serviceName - The fullly-qualified name of the service.\n   * @param {Object} clientConfig - A dictionary of the client config.\n   * @param {Object} configOverrides - A dictionary of overriding configs.\n   * @param {Object} headers - A dictionary of additional HTTP header name to\n   *   its value.\n   * @return {Object} A mapping of method names to CallSettings.\n   */\n  constructSettings(serviceName, clientConfig, configOverrides, headers) {\n    function buildMetadata(abTests, moreHeaders) {\n      const metadata = {};\n      if (!headers) {\n        headers = {};\n      }\n      // Since gRPC expects each header to be an array,\n      // we are doing the same for fallback here.\n      for (const key in headers) {\n        metadata[key] = Array.isArray(headers[key]) ? headers[key] : [headers[key]];\n      }\n      // gRPC-fallback request must have 'grpc-web/' in 'x-goog-api-client'\n      const clientVersions = [];\n      if (metadata[CLIENT_VERSION_HEADER] && metadata[CLIENT_VERSION_HEADER][0]) {\n        clientVersions.push(...metadata[CLIENT_VERSION_HEADER][0].split(' '));\n      }\n      clientVersions.push(`grpc-web/${exports.version}`);\n      metadata[CLIENT_VERSION_HEADER] = [clientVersions.join(' ')];\n      if (!moreHeaders) {\n        return metadata;\n      }\n      for (const key in moreHeaders) {\n        if (key.toLowerCase() !== CLIENT_VERSION_HEADER) {\n          const value = moreHeaders[key];\n          if (Array.isArray(value)) {\n            if (metadata[key] === undefined) {\n              metadata[key] = value;\n            } else {\n              if (Array.isArray(metadata[key])) {\n                metadata[key].push(...value);\n              } else {\n                throw new Error(`Can not add value ${value} to the call metadata.`);\n              }\n            }\n          } else {\n            metadata[key] = [value];\n          }\n        }\n      }\n      return metadata;\n    }\n    return gax.constructSettings(serviceName, clientConfig, configOverrides, status_1.Status, {\n      metadataBuilder: buildMetadata\n    });\n  }\n  /**\n   * gRPC-fallback version of createStub\n   * Creates a gRPC-fallback stub with authentication headers built from supplied OAuth2Client instance\n   *\n   * @param {function} CreateStub - The constructor function of the stub.\n   * @param {Object} service - A protobufjs Service object (as returned by lookupService)\n   * @param {Object} opts - Connection options, as described below.\n   * @param {string} opts.servicePath - The hostname of the API endpoint service.\n   * @param {number} opts.port - The port of the service.\n   * @return {Promise} A promise which resolves to a gRPC-fallback service stub, which is a protobuf.js service stub instance modified to match the gRPC stub API\n   */\n  async createStub(service, opts,\n  // For consistency with createStub in grpc.ts, customServicePath is defined:\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  customServicePath) {\n    if (!this.authClient) {\n      if (this.auth && 'getClient' in this.auth) {\n        this.authClient = await this.auth.getClient();\n      } else if (this.auth && 'getRequestHeaders' in this.auth) {\n        this.authClient = this.auth;\n      }\n    }\n    if (!this.authClient) {\n      throw new Error('No authentication was provided');\n    }\n    service.resolveAll();\n    const methods = GrpcClient.getServiceMethods(service);\n    const protocol = opts.protocol || 'https';\n    let servicePath = opts.servicePath;\n    if (!servicePath && service.options && service.options['(google.api.default_host)']) {\n      servicePath = service.options['(google.api.default_host)'];\n    }\n    if (!servicePath) {\n      throw new Error(`Cannot determine service API path for service ${service.name}.`);\n    }\n    let servicePort;\n    const match = servicePath.match(/^(.*):(\\d+)$/);\n    if (match) {\n      servicePath = match[1];\n      servicePort = parseInt(match[2]);\n    }\n    if (opts.port) {\n      servicePort = opts.port;\n    } else if (!servicePort) {\n      servicePort = 443;\n    }\n    const encoder = this.fallback === 'rest' ? fallbackRest.encodeRequest : fallbackProto.encodeRequest;\n    const decoder = this.fallback === 'rest' ? fallbackRest.decodeResponse : fallbackProto.decodeResponse;\n    const serviceStub = (0, fallbackServiceStub_1.generateServiceStub)(methods, protocol, servicePath, servicePort, this.authClient, encoder, decoder, this.numericEnums);\n    return serviceStub;\n  }\n  /**\n   * Creates a 'bytelength' function for a given proto message class.\n   *\n   * See {@link BundleDescriptor} about the meaning of the return value.\n   *\n   * @param {function} message - a constructor function that is generated by\n   *   protobuf.js. Assumes 'encoder' field in the message.\n   * @return {function(Object):number} - a function to compute the byte length\n   *   for an object.\n   */\n  static createByteLengthFunction(message) {\n    return gax.createByteLengthFunction(message);\n  }\n}\nexports.GrpcClient = GrpcClient;\nGrpcClient.protoCache = new Map();\n/**\n * gRPC-fallback version of lro\n *\n * @param {Object=} options.auth - An instance of google-auth-library.\n * @return {Object} A OperationsClientBuilder that will return a OperationsClient\n */\nfunction lro(options) {\n  options = Object.assign({\n    scopes: []\n  }, options);\n  if (options.protoJson) {\n    options = Object.assign(options, {\n      fallback: 'rest'\n    });\n  }\n  const gaxGrpc = new GrpcClient(options);\n  return new operationsClient_1.OperationsClientBuilder(gaxGrpc, options.protoJson);\n}\nexports.lro = lro;\n/**\n * gRPC-fallback version of createApiCall\n *\n * Converts an rpc call into an API call governed by the settings.\n *\n * In typical usage, `func` will be a promise to a callable used to make an rpc\n * request. This will mostly likely be a bound method from a request stub used\n * to make an rpc call. It is not a direct function but a Promise instance,\n * because of its asynchronism (typically, obtaining the auth information).\n *\n * The result is a function which manages the API call with the given settings\n * and the options on the invocation.\n *\n * Throws exception on unsupported streaming calls\n *\n * @param {Promise<GRPCCall>|GRPCCall} func - is either a promise to be used to make\n *   a bare RPC call, or just a bare RPC call.\n * @param {CallSettings} settings - provides the settings for this call\n * @param {Descriptor} descriptor - optionally specify the descriptor for\n *   the method call.\n * @return {GaxCall} func - a bound method on a request stub used\n *   to make an rpc call.\n */\nfunction createApiCall(func, settings, descriptor, fallback) {\n  if ((!fallback || fallback === 'rest') && descriptor && 'streaming' in descriptor && descriptor.type !== streaming_1.StreamType.SERVER_STREAMING) {\n    return () => {\n      throw new Error('The REST transport currently does not support client-streaming or bidi-stream calls.');\n    };\n  }\n  if ((fallback === 'proto' || fallback === true) &&\n  // for legacy reasons, fallback === true means 'proto'\n  descriptor && 'streaming' in descriptor) {\n    return () => {\n      throw new Error('The gRPC-fallback (proto over HTTP) transport currently does not support streaming calls.');\n    };\n  }\n  return (0, createApiCall_1.createApiCall)(func, settings, descriptor);\n}\nexports.createApiCall = createApiCall;\nexports.protobufMinimal = require(\"protobufjs/minimal\");\nvar warnings_1 = require(\"./warnings\");\nObject.defineProperty(exports, \"warn\", {\n  enumerable: true,\n  get: function () {\n    return warnings_1.warn;\n  }\n});\nvar longrunning_1 = require(\"./longRunningCalls/longrunning\");\nObject.defineProperty(exports, \"Operation\", {\n  enumerable: true,\n  get: function () {\n    return longrunning_1.Operation;\n  }\n});\nObject.defineProperty(exports, \"operation\", {\n  enumerable: true,\n  get: function () {\n    return longrunning_1.operation;\n  }\n});\nvar googleError_1 = require(\"./googleError\");\nObject.defineProperty(exports, \"GoogleError\", {\n  enumerable: true,\n  get: function () {\n    return googleError_1.GoogleError;\n  }\n});\n// Different environments or bundlers may or may not respect \"browser\" field\n// in package.json (e.g. Electron does not respect it, but if you run the code\n// through webpack first, it will follow the \"browser\" field).\n// To make it safer and more compatible, let's make sure that if you do\n// const gax = require(\"google-gax\");\n// you can always ask for gax.fallback, regardless of \"browser\" field being\n// understood or not.\nconst fallback = module.exports;\nexports.fallback = fallback;","map":{"version":3,"names":["objectHash","require","protobuf","exports","gax","routingHeader","status_1","google_auth_library_1","operationsClient_1","createApiCall_1","fallbackProto","fallbackRest","featureDetection_1","fallbackServiceStub_1","streaming_1","util_1","IamProtos","LocationProtos","operationsProtos","pathTemplate_1","Object","defineProperty","enumerable","get","PathTemplate","gax_1","CallSettings","constructSettings","RetryOptions","createDefaultBackoffSettings","version","descriptor_1","BundleDescriptor","LongrunningDescriptor","PageDescriptor","StreamDescriptor","streaming_2","StreamType","operationsClient_2","OperationsClient","iamService_1","IamClient","locationService_1","LocationsClient","defaultToObjectOptions","keepCase","longs","String","enums","defaults","oneofs","CLIENT_VERSION_HEADER","GrpcClient","clearProtoCache","protoCache","clear","constructor","options","arguments","length","undefined","isNodeJS","auth","Error","JSON","stringify","GoogleAuth","fallback","grpcVersion","httpRules","numericEnums","_a","loadProto","jsonObject","rootObject","Root","fromJSON","loadProtoJSON","json","ignoreCache","hash","toString","cached","root","set","getServiceMethods","service","methods","methodName","methodObject","entries","methodNameLowerCamelCase","toLowerCamelCase","serviceName","clientConfig","configOverrides","headers","buildMetadata","abTests","moreHeaders","metadata","key","Array","isArray","clientVersions","push","split","join","toLowerCase","value","Status","metadataBuilder","createStub","opts","customServicePath","authClient","getClient","resolveAll","protocol","servicePath","name","servicePort","match","parseInt","port","encoder","encodeRequest","decoder","decodeResponse","serviceStub","generateServiceStub","createByteLengthFunction","message","Map","lro","assign","scopes","protoJson","gaxGrpc","OperationsClientBuilder","createApiCall","func","settings","descriptor","type","SERVER_STREAMING","protobufMinimal","warnings_1","warn","longrunning_1","Operation","operation","googleError_1","GoogleError","module"],"sources":["../../src/fallback.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}