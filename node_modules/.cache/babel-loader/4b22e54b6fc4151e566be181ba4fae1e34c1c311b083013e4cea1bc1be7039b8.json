{"ast":null,"code":"const jose = require('jose');\nconst crypto = require('crypto');\nasync function retrieveSigningKeys(jwks) {\n  const results = [];\n  jwks = jwks.filter(_ref => {\n    let {\n      use\n    } = _ref;\n    return use === 'sig' || use === undefined;\n  }).filter(_ref2 => {\n    let {\n      kty\n    } = _ref2;\n    return kty === 'RSA' || kty === 'EC' || kty === 'OKP';\n  });\n  for (const jwk of jwks) {\n    try {\n      // The algorithm is actually not used in the Node.js KeyObject-based runtime\n      // passing an arbitrary value here and checking that KeyObject was returned\n      // later\n      const keyObject = await jose.importJWK(jwk, 'RS256');\n      if (!(keyObject instanceof crypto.KeyObject) || keyObject.type !== 'public') {\n        continue;\n      }\n      const getSpki = () => keyObject.export({\n        format: 'pem',\n        type: 'spki'\n      });\n      results.push({\n        get publicKey() {\n          return getSpki();\n        },\n        get rsaPublicKey() {\n          return getSpki();\n        },\n        getPublicKey() {\n          return getSpki();\n        },\n        ...(typeof jwk.kid === 'string' && jwk.kid ? {\n          kid: jwk.kid\n        } : undefined),\n        ...(typeof jwk.alg === 'string' && jwk.alg ? {\n          alg: jwk.alg\n        } : undefined)\n      });\n    } catch (err) {\n      continue;\n    }\n  }\n  return results;\n}\nmodule.exports = {\n  retrieveSigningKeys\n};","map":{"version":3,"names":["jose","require","crypto","retrieveSigningKeys","jwks","results","filter","_ref","use","undefined","_ref2","kty","jwk","keyObject","importJWK","KeyObject","type","getSpki","export","format","push","publicKey","rsaPublicKey","getPublicKey","kid","alg","err","module","exports"],"sources":["D:/Coding/React/taskmybusiness/node_modules/jwks-rsa/src/utils.js"],"sourcesContent":["const jose = require('jose');\nconst crypto = require('crypto');\n\nasync function retrieveSigningKeys(jwks) {\n  const results = [];\n\n  jwks = jwks\n    .filter(({ use }) => use === 'sig' || use === undefined)\n    .filter(({ kty }) => kty === 'RSA' || kty === 'EC' || kty === 'OKP');\n\n  for (const jwk of jwks) {\n    try {\n      // The algorithm is actually not used in the Node.js KeyObject-based runtime\n      // passing an arbitrary value here and checking that KeyObject was returned\n      // later\n      const keyObject = await jose.importJWK(jwk, 'RS256');\n      if (!(keyObject instanceof crypto.KeyObject) || keyObject.type !== 'public') {\n        continue;\n      }\n      const getSpki = () => keyObject.export({ format: 'pem', type: 'spki' });\n      results.push({\n        get publicKey() { return getSpki(); },\n        get rsaPublicKey() { return getSpki(); },\n        getPublicKey() { return getSpki(); },\n        ...(typeof jwk.kid === 'string' && jwk.kid ? { kid: jwk.kid } : undefined),\n        ...(typeof jwk.alg === 'string' && jwk.alg ? { alg: jwk.alg } : undefined)\n      });\n    } catch (err) {\n      continue;\n    }\n  }\n\n  return results;\n}\n\nmodule.exports = {\n  retrieveSigningKeys\n};\n"],"mappings":"AAAA,MAAMA,IAAI,GAAGC,OAAO,CAAC,MAAM,CAAC;AAC5B,MAAMC,MAAM,GAAGD,OAAO,CAAC,QAAQ,CAAC;AAEhC,eAAeE,mBAAmBA,CAACC,IAAI,EAAE;EACvC,MAAMC,OAAO,GAAG,EAAE;EAElBD,IAAI,GAAGA,IAAI,CACRE,MAAM,CAACC,IAAA;IAAA,IAAC;MAAEC;IAAI,CAAC,GAAAD,IAAA;IAAA,OAAKC,GAAG,KAAK,KAAK,IAAIA,GAAG,KAAKC,SAAS;EAAA,EAAC,CACvDH,MAAM,CAACI,KAAA;IAAA,IAAC;MAAEC;IAAI,CAAC,GAAAD,KAAA;IAAA,OAAKC,GAAG,KAAK,KAAK,IAAIA,GAAG,KAAK,IAAI,IAAIA,GAAG,KAAK,KAAK;EAAA,EAAC;EAEtE,KAAK,MAAMC,GAAG,IAAIR,IAAI,EAAE;IACtB,IAAI;MACF;MACA;MACA;MACA,MAAMS,SAAS,GAAG,MAAMb,IAAI,CAACc,SAAS,CAACF,GAAG,EAAE,OAAO,CAAC;MACpD,IAAI,EAAEC,SAAS,YAAYX,MAAM,CAACa,SAAS,CAAC,IAAIF,SAAS,CAACG,IAAI,KAAK,QAAQ,EAAE;QAC3E;MACF;MACA,MAAMC,OAAO,GAAGA,CAAA,KAAMJ,SAAS,CAACK,MAAM,CAAC;QAAEC,MAAM,EAAE,KAAK;QAAEH,IAAI,EAAE;MAAO,CAAC,CAAC;MACvEX,OAAO,CAACe,IAAI,CAAC;QACX,IAAIC,SAASA,CAAA,EAAG;UAAE,OAAOJ,OAAO,CAAC,CAAC;QAAE,CAAC;QACrC,IAAIK,YAAYA,CAAA,EAAG;UAAE,OAAOL,OAAO,CAAC,CAAC;QAAE,CAAC;QACxCM,YAAYA,CAAA,EAAG;UAAE,OAAON,OAAO,CAAC,CAAC;QAAE,CAAC;QACpC,IAAI,OAAOL,GAAG,CAACY,GAAG,KAAK,QAAQ,IAAIZ,GAAG,CAACY,GAAG,GAAG;UAAEA,GAAG,EAAEZ,GAAG,CAACY;QAAI,CAAC,GAAGf,SAAS,CAAC;QAC1E,IAAI,OAAOG,GAAG,CAACa,GAAG,KAAK,QAAQ,IAAIb,GAAG,CAACa,GAAG,GAAG;UAAEA,GAAG,EAAEb,GAAG,CAACa;QAAI,CAAC,GAAGhB,SAAS;MAC3E,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOiB,GAAG,EAAE;MACZ;IACF;EACF;EAEA,OAAOrB,OAAO;AAChB;AAEAsB,MAAM,CAACC,OAAO,GAAG;EACfzB;AACF,CAAC"},"metadata":{},"sourceType":"script","externalDependencies":[]}