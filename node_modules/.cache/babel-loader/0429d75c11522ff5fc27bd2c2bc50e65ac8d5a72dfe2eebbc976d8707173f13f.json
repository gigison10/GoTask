{"ast":null,"code":"import _regeneratorRuntime from\"D:/Coding/React/taskmybusiness/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"D:/Coding/React/taskmybusiness/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"D:/Coding/React/taskmybusiness/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/Coding/React/taskmybusiness/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import\"./project-page.scss\";import{db}from\"../../utils/firebase/firebase-utils\";import{collection,addDoc,deleteDoc,doc,setDoc}from\"firebase/firestore\";import{useState,useContext,useEffect}from\"react\";import ProjectAdd from\"../projectAdd-field/project-add\";import ProjectField from\"../projectField/projectField\";import{ProjectsContext,UserContext,updateProjectsContext}from\"../../contexts/context\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ProjectPage(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),projectDetails=_useState2[0],setProjectDetails=_useState2[1];var _useContext=useContext(UserContext),currentUser=_useContext.currentUser,setCurrentUser=_useContext.setCurrentUser;var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),userId=_useState4[0],setUserId=_useState4[1];var _useContext2=useContext(ProjectsContext),currentProject=_useContext2.currentProject;var _useContext3=useContext(updateProjectsContext),setUpdateCurrentProjects=_useContext3.setUpdateCurrentProjects;var _useState5=useState(1),_useState6=_slicedToArray(_useState5,2),rerender=_useState6[0],setRerender=_useState6[1];console.log(projectDetails);function deleteProject(_x){return _deleteProject.apply(this,arguments);}function _deleteProject(){_deleteProject=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(projectId){var projectDocRef;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:console.log(projectId);_context2.prev=1;projectDocRef=doc(db,\"users/\".concat(userId,\"/projects/\").concat(projectId));_context2.next=5;return deleteDoc(projectDocRef);case 5:setUpdateCurrentProjects(\"delete\");setRerender(rerender+1);console.log(\"Project deleted successfully\");_context2.next=13;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](1);console.error(\"Error deleting project:\",_context2.t0);case 13:case\"end\":return _context2.stop();}},_callee2,null,[[1,10]]);}));return _deleteProject.apply(this,arguments);}useEffect(function(){userCheck();},[currentUser,rerender,userCheck]);function userCheck(){if(currentUser){setTimeout(function(){getProjects();setUserId(currentUser.uid);},\"1500\");}else{setProjectDetails([]);return;}}function getProjects(){setProjectDetails(currentProject.map(function(e){return{projectId:e.projectId,projectName:e.projectName,startingDate:e.startingDate,deadLine:e.deadLine};}));setCurrentUser(currentUser);}function onSaveProjectDetailsHandler(inputProjectDetails){var createProject=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var projectData,docRef,projectDataWithId,projectDocRef;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;projectData={projectName:inputProjectDetails.projectName,startingDate:inputProjectDetails.startingDate,deadLine:inputProjectDetails.deadLine};// Add the project data to the \"projects\" collection in Firestore\n_context.next=4;return addDoc(collection(db,\"users/\".concat(userId,\"/projects\")),projectData);case 4:docRef=_context.sent;projectDataWithId=_objectSpread(_objectSpread({},projectData),{},{projectId:docRef.id});_context.next=8;return doc(db,\"users/\".concat(userId,\"/projects/\").concat(docRef.id));case 8:projectDocRef=_context.sent;setDoc(projectDocRef,projectDataWithId);// setProjectId(docRef.id);\nsetUpdateCurrentProjects(docRef.id);setRerender(rerender+1);// console.log(\"Project ID:\", docRef.id);\n_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](0);console.error(\"Error creating project:\",_context.t0);case 17:case\"end\":return _context.stop();}},_callee,null,[[0,14]]);}));return function createProject(){return _ref.apply(this,arguments);};}();createProject();}return/*#__PURE__*/_jsxs(\"div\",{className:\"project-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"project-menu\",children:[/*#__PURE__*/_jsx(\"div\",{children:\"sort by\"}),/*#__PURE__*/_jsx(\"div\",{children:\"sort by\"}),/*#__PURE__*/_jsx(\"div\",{children:\"sort by\"}),/*#__PURE__*/_jsx(\"div\",{children:\"something\"})]}),/*#__PURE__*/_jsx(ProjectAdd,{onSaveProjectDetails:onSaveProjectDetailsHandler}),/*#__PURE__*/_jsx(ProjectField,{projectDetails:projectDetails,deleteProject:deleteProject})]});}export default ProjectPage;","map":{"version":3,"names":["db","collection","addDoc","deleteDoc","doc","setDoc","useState","useContext","useEffect","ProjectAdd","ProjectField","ProjectsContext","UserContext","updateProjectsContext","jsx","_jsx","jsxs","_jsxs","ProjectPage","_useState","_useState2","_slicedToArray","projectDetails","setProjectDetails","_useContext","currentUser","setCurrentUser","_useState3","_useState4","userId","setUserId","_useContext2","currentProject","_useContext3","setUpdateCurrentProjects","_useState5","_useState6","rerender","setRerender","console","log","deleteProject","_x","_deleteProject","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee2","projectId","projectDocRef","wrap","_callee2$","_context2","prev","next","concat","t0","error","stop","userCheck","setTimeout","getProjects","uid","map","e","projectName","startingDate","deadLine","onSaveProjectDetailsHandler","inputProjectDetails","createProject","_ref","_callee","projectData","docRef","projectDataWithId","_callee$","_context","sent","_objectSpread","id","className","children","onSaveProjectDetails"],"sources":["D:/Coding/React/taskmybusiness/src/components/projects-page/project-page.jsx"],"sourcesContent":["import \"./project-page.scss\";\r\nimport { db } from \"../../utils/firebase/firebase-utils\";\r\nimport { collection, addDoc, deleteDoc, doc, setDoc } from \"firebase/firestore\";\r\n\r\nimport { useState, useContext, useEffect } from \"react\";\r\nimport ProjectAdd from \"../projectAdd-field/project-add\";\r\nimport ProjectField from \"../projectField/projectField\";\r\nimport {\r\n  ProjectsContext,\r\n  UserContext,\r\n  updateProjectsContext,\r\n} from \"../../contexts/context\";\r\n\r\nfunction ProjectPage() {\r\n  const [projectDetails, setProjectDetails] = useState([]);\r\n  const { currentUser, setCurrentUser } = useContext(UserContext);\r\n  const [userId, setUserId] = useState(\"\");\r\n  const { currentProject } = useContext(ProjectsContext);\r\n  const { setUpdateCurrentProjects } = useContext(updateProjectsContext);\r\n  const [rerender, setRerender] = useState(1);\r\n\r\n  console.log(projectDetails);\r\n  async function deleteProject(projectId) {\r\n    console.log(projectId);\r\n    try {\r\n      const projectDocRef = doc(db, `users/${userId}/projects/${projectId}`);\r\n      await deleteDoc(projectDocRef);\r\n\r\n      setUpdateCurrentProjects(\"delete\");\r\n      setRerender(rerender + 1);\r\n      console.log(\"Project deleted successfully\");\r\n    } catch (error) {\r\n      console.error(\"Error deleting project:\", error);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    userCheck();\r\n  }, [currentUser, rerender, userCheck]);\r\n\r\n  function userCheck() {\r\n    if (currentUser) {\r\n      setTimeout(() => {\r\n        getProjects();\r\n        setUserId(currentUser.uid);\r\n      }, \"1500\");\r\n    } else {\r\n      setProjectDetails([]);\r\n      return;\r\n    }\r\n  }\r\n\r\n  function getProjects() {\r\n    setProjectDetails(\r\n      currentProject.map((e) => ({\r\n        projectId: e.projectId,\r\n        projectName: e.projectName,\r\n        startingDate: e.startingDate,\r\n        deadLine: e.deadLine,\r\n      }))\r\n    );\r\n    setCurrentUser(currentUser);\r\n  }\r\n\r\n  function onSaveProjectDetailsHandler(inputProjectDetails) {\r\n    const createProject = async () => {\r\n      try {\r\n        let projectData = {\r\n          projectName: inputProjectDetails.projectName,\r\n          startingDate: inputProjectDetails.startingDate,\r\n          deadLine: inputProjectDetails.deadLine,\r\n        };\r\n\r\n        // Add the project data to the \"projects\" collection in Firestore\r\n\r\n        const docRef = await addDoc(\r\n          collection(db, `users/${userId}/projects`),\r\n          projectData\r\n        );\r\n\r\n        const projectDataWithId = {\r\n          ...projectData,\r\n          projectId: docRef.id,\r\n        };\r\n        const projectDocRef = await doc(\r\n          db,\r\n          `users/${userId}/projects/${docRef.id}`\r\n        );\r\n\r\n        setDoc(projectDocRef, projectDataWithId);\r\n\r\n        // setProjectId(docRef.id);\r\n        setUpdateCurrentProjects(docRef.id);\r\n        setRerender(rerender + 1);\r\n\r\n        // console.log(\"Project ID:\", docRef.id);\r\n      } catch (error) {\r\n        console.error(\"Error creating project:\", error);\r\n      }\r\n    };\r\n    createProject();\r\n  }\r\n\r\n  return (\r\n    <div className=\"project-container\">\r\n      <div className=\"project-menu\">\r\n        <div>sort by</div>\r\n        <div>sort by</div>\r\n        <div>sort by</div>\r\n        <div>something</div>\r\n        {/* <div className=\"button\">Add project</div> */}\r\n      </div>\r\n      <ProjectAdd onSaveProjectDetails={onSaveProjectDetailsHandler} />\r\n      <ProjectField\r\n        projectDetails={projectDetails}\r\n        deleteProject={deleteProject}\r\n      />\r\n      {/* <button onClick={createProject}>Create Project</button> */}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ProjectPage;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}